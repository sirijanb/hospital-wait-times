@page "/admin"
@inject AuthenticationStateProvider Auth
@inject NavigationManager Navigation
@attribute [Authorize(Roles = "MasterAdmin")]

<h3>Master Admin Dashboard</h3>

<p>Welcome, Admin ðŸ‘‹</p>

<ul>
    <li>
        <a href="/admin/hospitals">View All Hospitals</a>
    </li>
    <li>
        <a href="/admin/hospital-reps">View All Hospital Representatives</a>
    </li>
</ul>
@code {
    protected override async Task OnInitializedAsync()
    {
        var state = await Auth.GetAuthenticationStateAsync();
        Console.WriteLine($">>>>> IsAuthenticated: {state.User.Identity?.IsAuthenticated}");
        Console.WriteLine(string.Join(",", state.User.Claims.Select(c => $"{c.Type}:{c.Value}")));


        @* var authState = await Auth.GetAuthenticationStateAsync();
        var user = authState.User;
        if (user != null && user.Identity != null)
        {
            if (!user.Identity.IsAuthenticated || !user.IsInRole("MasterAdmin"))
            {
                Navigation.NavigateTo("/login");
            }
        } *@
    }

    protected override void OnInitialized()
    {
        @* Console.WriteLine(">>>> OnInitialized fired!!"); *@
        @* var authState = await Auth.GetAuthenticationStateAsync();
        var user = authState.User;
        if (user != null && user.Identity != null)
        {
            if (!user.Identity.IsAuthenticated || !user.IsInRole("MasterAdmin"))
            {
                Navigation.NavigateTo("/login");
            }
        } *@
    }
}